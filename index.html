<!DOCTYPE html>
<html>
<head>
  <title>Outlet Dashboard</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    label { margin-right: 10px; }
    select, input { margin: 5px; padding: 5px; }
    table { margin-top: 20px; border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #f2f2f2; }
    .negative { background-color: #ffdddd; color: red; }
    .positive { background-color: #ddffdd; color: green; }
  </style>
</head>
<body>

<h2>Outlet Sales Dashboard</h2>

<label>Distribution:</label>
<select id="distributionSelect" onchange="loadRoutes()"></select>

<label>Route:</label>
<select id="routeSelect" onchange="filterData()"></select>

<label>Day:</label>
<select id="daySelect" onchange="filterData()">
  <option value="Monday">Monday</option>
  <option value="Tuesday">Tuesday</option>
  <option value="Wednesday">Wednesday</option>
  <option value="Thursday">Thursday</option>
  <option value="Friday">Friday</option>
  <option value="Saturday">Saturday</option>
  <option value="Sunday">Sunday</option>
</select>

<label>Search Outlet:</label>
<input type="text" id="searchInput" placeholder="Enter outlet name" oninput="filterData()">

<table id="dataTable">
  <thead>
    <tr>
      <th>Outlet Name</th>
      <th>Target</th>
      <th>MTD Sale</th>
      <th>Remaining</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
let data = [];

fetch('data.json')
  .then(response => response.json())
  .then(json => {
    data = json;
    loadDistributions();
  });

function loadDistributions() {
  const distSelect = document.getElementById('distributionSelect');
  const uniqueDists = [...new Set(data.map(d => d.Distribution))];
  distSelect.innerHTML = '<option value="">Select</option>' + uniqueDists.map(d => `<option>${d}</option>`).join('');
}

function loadRoutes() {
  const selectedDist = document.getElementById('distributionSelect').value;
  const routeSelect = document.getElementById('routeSelect');
  const filtered = data.filter(d => d.Distribution === selectedDist);
  const uniqueRoutes = [...new Set(filtered.map(d => d.Route))];
  routeSelect.innerHTML = '<option value="">Select</option>' + uniqueRoutes.map(r => `<option>${r}</option>`).join('');
  filterData();
}

function filterData() {
  const dist = document.getElementById('distributionSelect').value;
  const route = document.getElementById('routeSelect').value;
  const day = document.getElementById('daySelect').value;
  const search = document.getElementById('searchInput').value.toLowerCase();

  const filtered = data.filter(d =>
    (!dist || d.Distribution === dist) &&
    (!route || d.Route === route) &&
    d[day] == 1 &&
    (!search || d.Outlet.toLowerCase().includes(search))
  );

  const tbody = document.querySelector('#dataTable tbody');
  tbody.innerHTML = filtered.map(row => {
    const remainingClass = row.Remaining < 0 ? 'negative' : 'positive';
    return `
      <tr>
        <td>${row.Outlet}</td>
        <td>${row.Target}</td>
        <td>${row.MTD_Sale}</td>
        <td class="${remainingClass}">${row.Remaining}</td>
      </tr>
    `;
  }).join('');
}
</script>

</body>
</html>
